{
  "project": "complianceloop-site",
  "repo": "ComplianceLoop/complianceloop-site",
  "currentPhase": "Assignment engine",
  "phases": [
    { "name": "Foundations", "status": "landed" },
    { "name": "Auth & Session", "status": "landed" },
    { "name": "Provider directory & eligibility", "status": "landed", "landedAt": "2025-10-10" },
    { "name": "Assignment engine", "status": "in_progress" },
    { "name": "Post-assignment ops", "status": "planned" },
    { "name": "Billing", "status": "planned" },
    { "name": "Reporting", "status": "planned" },
    { "name": "Audit & exports", "status": "planned" },
    { "name": "Admin UX", "status": "planned" },
    { "name": "Notifications", "status": "planned" },
    { "name": "Observability", "status": "planned" },
    { "name": "SRE & runbooks", "status": "planned" },
    { "name": "Final hardening", "status": "planned" }
  ],
  "phaseProgress": {
    "Assignment engine": {
      "status": "in_progress",
      "decisions": [
        {
          "key": "table_namespace",
          "value": "assign_* (assign_jobs, assign_job_offers, assign_job_assignments, assign_logs)",
          "notes": "Isolated from any legacy jobs table to avoid collisions."
        },
        {
          "key": "broadcast_model",
          "value": "soft-hold offers",
          "notes": "Offers expire at now() + (hold_minutes * 1 minute)."
        }
      ],
      "tasks": [
        { "name": "broadcast endpoint", "path": "apps/portal/app/api/assign/broadcast/route.ts", "status": "implemented" },
        { "name": "soft-hold semantics", "status": "implemented" },
        { "name": "first-accept wins (atomic)", "path": "apps/portal/app/api/assign/accept/route.ts", "status": "implemented" },
        { "name": "single-eligible auto-assign", "status": "implemented" },
        { "name": "decline endpoint", "path": "apps/portal/app/api/assign/decline/route.ts", "status": "implemented" },
        { "name": "minimal admin logs endpoint", "path": "apps/portal/app/api/assign/admin/logs/route.ts", "status": "implemented" },
        { "name": "bootstrap (DDL) inline", "path": "apps/portal/app/api/db/bootstrap/route.ts", "status": "implemented" },
        { "name": "safe rollbacks", "status": "documented" }
      ],
      "verifyNotes": [
        "POST /api/assign/broadcast with telehealth_consult + 00901 returns job_id and eligible_count >= 2 after seeding.",
        "POST /api/assign/accept twice: exactly one 200; the other 409 (winner echoed).",
        "POST /api/assign/decline returns 200 on unexpired offer.",
        "GET /api/assign/admin/logs?job_id=<id> shows broadcast_offers_created, offer_accepted, offer_declined."
      ]
    }
  },
  "operationalNotes": {
    "previewUrlPolicy": "Prefer Production alias https://complianceloop-portal.vercel.app; for protected previews use header X-Vercel-Protection-Bypass with secret stored out-of-band.",
    "apiTestingResults": [
      "2025-10-12 - broadcast ok: job_id=4a1fc20d-11d8-4006-8aeb-f5276830f26f, eligible_count=2.",
      "2025-10-12 - accept ok: job_id=23442e4a-842a-4a83-8b66-79d8f0625522, winner_provider_id=e3587419-076b-4381-b91d-23131b635e1f.",
      "2025-10-12 - decline ok: job_id=e1dc1b62-c177-4215-b6ab-2c11cc297458, provider_id=cf582d89-caeb-4655-913f-43d0ed0e03c7, state=declined.",
      "2025-10-12 - logs ok: admin/logs reflects broadcast_offers_created, offer_accepted, offer_declined."
    ]
  }
}
